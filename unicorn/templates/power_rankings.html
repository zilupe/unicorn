<h2 class="mt-5 mb-3">Power Rankings</h2>

<p>Power rankings formula is still a work in progress. Current formula:</p>

<ul>
    <li>Old wins/losses are never forgotten</li>
    <li>Points difference does not matter</li>
    <li>Wins due to forfeits are as valuable as normal wins
        (this is so that not showing up doesn't save your ranking)
    </li>
    <li>The stronger team you beat the more points you get</li>
    <li>The weaker team you lose to the more points you lose</li>
    <li>Drawing with a weaker team makes you lose points</li>
    <li>Drawing with a stronger team makes you win points</li>
    <li>Regular season games have worth coefficient of 0.05</li>
    <li>Semi-finals have worth coefficient of 0.07</li>
    <li>Finals have worth coefficient of 0.08</li>
    <li>3rd place game has worth coefficient of 0.06</li>
    <li>Other games played as part of play-off weeks have worth coefficient of 0.04</li>
    <li>Everyone starts at 1000</li>
    <li>After every game one team gains X points, the other loses exactly the same amount.</li>
    <li><strong>There are bugs in the current calculation/presentation, just look at Halo Hoops best win.</strong></li>
</ul>

<table class="table table-border data-table-simple mt-5">
    <thead>
        <tr>
            <th class="text-center">Rank</th>
            <th>&nbsp;</th>
            <th>Franchise</th>
            <th class="text-center">Current Rating</th>
            <th class="text-center">Best Rating</th>
            <th class="text-center" data-orderable="false">Best Win</th>
            <th class="text-center">Worst Rating</th>
            <th class="text-center" data-orderable="false">Worst Defeat</th>
        </tr>

    </thead>
    <tbody>
    {% for rank, pr in power_rankings %}
        <tr>
            <th class="text-center align-middle">{{ rank }}</th>
            <td class="align-middle text-center">
                {{ pr.franchise.logo_html|safe }}
            </td>
            <td class="align-middle">
                {{ pr.franchise.simple_link|safe }}
                {% if pr.franchise.status == 'inactive' %}
                    <em>inactive</em>
                {% endif %}
            </td>
            <td class="table-primary text-center align-middle">
                <strong style="font-size: x-large;">{{ pr.current.int_value }}</strong>
            </td>
            <td class="table-success text-center align-middle">
                {{ pr.best_rating.int_value }}
                {% if pr.best_rating.game %}
                    <br>
                    <small>
                        <a href="{{ pr.best_rating.game.simple_url }}">{{ pr.best_rating.game.pretty_date_str }}</a>
                    </small>
                {% endif %}
            </td>
            <td class="table-success text-center align-middle">
                {% if pr.best_game %}
                    {{ pr.best_game.change_int_value }}
                    <br>
                    <small>
                        {{ pr.best_game.game.winner_side.score_link|safe }} vs {{ pr.best_game.game.loser_side.team.simple_link|safe }}
                    </small>
                {% endif %}
            </td>
            <td class="table-danger text-center align-middle">
                {{ pr.worst_rating.int_value }}
                {% if pr.worst_rating.game %}
                    <br>
                    <small>
                        <a href="{{ pr.worst_rating.game.simple_url }}">{{ pr.worst_rating.game.pretty_date_str }}</a>
                    </small>
                {% endif %}
            </td>
            <td class="table-danger text-center align-middle">
                {% if pr.worst_game %}
                    {{ pr.worst_game.change_int_value }}
                    <br>
                    <small>
                        {{ pr.worst_game.game.loser_side.score_link|safe }} vs {{ pr.worst_game.game.winner_side.team.simple_link|safe }}
                    </small>
                {% endif %}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
