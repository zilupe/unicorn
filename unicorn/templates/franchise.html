
<div class="media mt-5">
    <div class="align-self-center mr-3">{{ franchise.logo_html|safe }}</div>
    <div class="media-body">
        <h1 class="display-3">
            {{ franchise.name }}
            {{ franchise.trophy_list_html|safe }}
        </h1>
    </div>
</div>


<h3 class="mt-5 mb-3">Summary</h3>

<table class="table">
    <thead>
        <tr>
            <th colspan="5">Seasons</th>
            <th colspan="3">Games</th>
        </tr>
        <tr>
            <th>Total</th>
            <th>Championship<br>Titles</th>
            <th>Regular Season<br>Winners</th>
            <th>First<br>Season</th>
            <th>Most Recent<br>Season</th>
            <th>Won</th>
            <th>Drawn</th>
            <th>Lost</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td>{{ franchise.num_seasons }}</td>
            <td>{{ franchise.finals_num_winners }}</td>
            <td>{{ franchise.regular_num_winners }}</td>
            <td>{{ franchise.teams[0].season.simple_link|safe }}</td>
            <td>{{ franchise.teams[-1].season.simple_link|safe }}</td>
            <td>{{ franchise.outcomes['W'] }}</td>
            <td>{{ franchise.outcomes['D'] }}</td>
            <td>{{ franchise.outcomes['L'] }}</td>
        </tr>
    </tbody>
</table>

<h3 class="mt-5 mb-3">All Seasons</h3>

<table class="table table-hover table-bordered table-sm">
    <thead class="thead-light">
        <tr>
            <th rowspan="2">Season</th>
            <th rowspan="2">Team</th>
            <th colspan="7">Regular Season</th>
            <th colspan="6">Finals</th>
            <th colspan="5">Totals</th>
        </tr>
        <tr>
            <th>Record</th>
            <th>Points</th>
            <th>Win %</th>
            <th>For</th>
            <th>Against</th>
            <th>+/-</th>
            <th>Rank</th>

            <th>Record</th>
            <th>Win %</th>
            <th>For</th>
            <th>Against</th>
            <th>+/-</th>
            <th>Rank</th>

            <th>Record</th>
            <th>Win %</th>
            <th>For</th>
            <th>Against</th>
            <th>+/-</th>
        </tr>
    </thead>
    <tbody>
        {% for team in franchise.teams_sorted %}
            <tr>
                <td>{{ team.season.simple_link|safe }}</td>
                <td>{{ team.simple_link|safe }}</td>

                <td>{{ team.regular_record_str }}</td>
                <td>{{ '%.2f'| format(team.regular_points_avg) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.regular_win_percentage) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.regular_score_for_avg) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.regular_score_against_avg) }}</td>
                <td style="text-align: right">{{ '%+.1f'| format(team.regular_score_difference_avg) }}</td>
                <td>{{ team.regular_rank }}</td>


                <td>{{ team.finals_record_str }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.finals_win_percentage) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.finals_score_for_avg) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.finals_score_against_avg) }}</td>
                <td style="text-align: right">{{ '%+.1f'| format(team.finals_score_difference_avg) }}</td>
                <td>{{ team.finals_rank }}</td>

                <td>{{ team.total_record_str }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.total_win_percentage) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.total_score_for_avg) }}</td>
                <td style="text-align: right">{{ '%.1f'| format(team.total_score_against_avg) }}</td>
                <td style="text-align: right">{{ '%+.1f'| format(team.total_score_difference_avg) }}</td>
            </tr>
        {% endfor %}
    </tbody>
</table>

<h3 class="mt-5 mb-3">Head to Head Summary</h3>

<table class="table table-hover">
    <thead>
        <tr>
            <th>Franchise</th>

            <th>Played</th>
            <th>Won</th>
            <th>Drawn</th>
            <th>Lost</th>

            <th class="text-right">Win %</th>

            <th class="text-right">For</th>
            <th class="text-right">Against</th>
            <th class="text-right">+/-</th>

            <th>First Game</th>
            <th>Last Game</th>
            <th>Streak</th>
        </tr>
    </thead>
    <tbody>
    {% for other in franchise.h2h_stats %}
        <tr>
            <td>
                <div class="media">
                    <div class="align-self-center mr-3">
                        {{ other.franchise.logo_html|safe }}
                    </div>
                    <div class="media-body">
                        {{ other.franchise.simple_link|safe }}
                        {{ other.franchise.trophy_list_html|safe }}
                    </div>
                </div>
            </td>

            <th>{{ other.total_played }}</th>

            {% if other.total_played > 0 %}

                <th class="text-center">{{ other.total_won_sum }}</th>
                <th class="text-center">{{ other.total_drawn_sum }}</th>
                <th class="text-center">{{ other.total_lost_sum }}</th>

                <th class="text-right">{{ '%0.1f'| format(other.total_win_percentage) }}</th>

                <th class="text-right">{{ '%0.1f'| format(other.total_score_for_avg) }}</th>
                <th class="text-right">{{ '%0.1f'| format(other.total_score_against_avg) }}</th>
                <th class="text-right">{{ '%+0.1f'| format(other.total_score_difference_avg) }}</th>

                <th>{{ other.games[0].date_link|safe }}</th>
                <th>{{ other.games[-1].date_link|safe }}</th>

                <th><a href="{{ franchise.simple_url }}#h2h_vs_{{ other.franchise.id }}">{{ other.streak }}</a></th>

            {% else %}

                <th colspan="10">&nbsp;</th>

            {% endif %}
        </tr>
    {% endfor %}
    </tbody>
</table>


{% for other in franchise.h2h_stats %}

    {% if other.total_played > 0 %}

        <h4 class="mt-4 mb-2" id="h2h_vs_{{ other.franchise.id }}">
            <div class="media">
                <div class="align-self-center mr-3">
                    {{ other.franchise.logo_html|safe }}
                </div>
                <div class="media-body">
                    {{ other.franchise.simple_link|safe }}
                    {{ other.franchise.trophy_list_html|safe }}
                    Head to Head
                </div>
            </div>
        </h4>

        <table class="table table-hover h2h-stats">

            <thead>
                <tr>
                    <th>Date</th>
                    <th>Season</th>
                    <th>Stage</th>
                    <th>Score</th>
                    <th>Outcome</th>
                </tr>
            </thead>

            <tbody>

                {% for gs in other.games_reversed %}
                    <tr>
                        <td>{{ gs.game.date_str }} {{ gs.game.time_str }}</td>
                        <td>{{ gs.game.season.simple_link|safe }}</td>
                        <td>{{ gs.game.season_stage }}</td>
                        <td>{{ gs.score_link|safe }}</td>
                        <td>{{ gs.outcome }}</td>
                    </tr>
                {% endfor %}

            </tbody>

        </table>

    {% endif %}

{% endfor %}
